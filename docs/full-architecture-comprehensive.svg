<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 1000">
  <defs>
    <style>
      .vpc-box { fill: #E3F2FD; stroke: #1976D2; stroke-width: 3; }
      .az-box { fill: #F5F5F5; stroke: #757575; stroke-width: 2; stroke-dasharray: 5,5; }
      .public-subnet { fill: #E8F5E9; stroke: #4CAF50; stroke-width: 2; }
      .private-app-subnet { fill: #FFF4E6; stroke: #FF9800; stroke-width: 2; }
      .private-db-subnet { fill: #FCE4EC; stroke: #E91E63; stroke-width: 2; }
      .component { fill: #FFFFFF; stroke: #424242; stroke-width: 1.5; }
      .aws-service { fill: #FFECB3; stroke: #FFA000; stroke-width: 2; }
      .frontend { fill: #E1BEE7; stroke: #8E24AA; stroke-width: 2; }
      .title { font-size: 14px; font-weight: bold; fill: #212121; }
      .subtitle { font-size: 11px; fill: #555; }
      .label { font-size: 10px; fill: #666; }
      .small-label { font-size: 9px; fill: #777; }
      .arrow { stroke: #424242; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#424242"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#4CAF50"/>
    </marker>
    <marker id="arrowhead-orange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#FF6F00"/>
    </marker>
    <marker id="arrowhead-purple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#8E24AA"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" font-size="22" font-weight="bold" fill="#1976D2">
    Spring PetClinic Microservices - Complete AWS Architecture
  </text>
  <text x="700" y="52" text-anchor="middle" font-size="12" fill="#555">
    Multi-AZ, High Availability, Serverless AI Integration
  </text>
  
  <!-- Users/Internet -->
  <g>
    <ellipse cx="700" cy="100" rx="100" ry="35" fill="#BBDEFB" stroke="#1976D2" stroke-width="2"/>
    <text x="700" y="105" text-anchor="middle" class="title" fill="#0D47A1">Users / Internet</text>
  </g>
  
  <!-- CloudFront -->
  <g>
    <rect x="50" y="150" width="180" height="70" class="frontend" rx="5"/>
    <text x="140" y="175" text-anchor="middle" class="title" fill="#8E24AA">CloudFront CDN</text>
    <text x="140" y="192" text-anchor="middle" class="small-label">Global Distribution</text>
    <text x="140" y="207" text-anchor="middle" class="small-label">HTTPS, Cache</text>
  </g>
  
  <!-- Route 53 -->
  <g>
    <rect x="270" y="150" width="160" height="70" class="aws-service" rx="5"/>
    <text x="350" y="175" text-anchor="middle" class="title" fill="#FFA000">Route 53</text>
    <text x="350" y="192" text-anchor="middle" class="small-label">DNS Management</text>
    <text x="350" y="207" text-anchor="middle" class="small-label">Health Checks</text>
  </g>
  
  <!-- WAF -->
  <g>
    <rect x="470" y="150" width="140" height="70" class="aws-service" rx="5"/>
    <text x="540" y="175" text-anchor="middle" class="title" fill="#FFA000">AWS WAF</text>
    <text x="540" y="192" text-anchor="middle" class="small-label">Web Firewall</text>
    <text x="540" y="207" text-anchor="middle" class="small-label">DDoS Protection</text>
  </g>
  
  <!-- S3 Static Hosting -->
  <g>
    <rect x="50" y="250" width="180" height="60" class="frontend" rx="5"/>
    <text x="140" y="272" text-anchor="middle" class="title" fill="#8E24AA">S3 Bucket</text>
    <text x="140" y="287" text-anchor="middle" class="small-label">Static Website</text>
    <text x="140" y="300" text-anchor="middle" class="small-label">HTML/JS/CSS</text>
  </g>
  
  <!-- Internet Gateway -->
  <g>
    <rect x="620" y="240" width="160" height="50" class="component" rx="5"/>
    <text x="700" y="265" text-anchor="middle" class="subtitle" font-weight="bold">Internet Gateway</text>
    <text x="700" y="280" text-anchor="middle" class="small-label">VPC Ingress/Egress</text>
  </g>
  
  <!-- VPC Border -->
  <rect x="40" y="320" width="1320" height="630" class="vpc-box" rx="10"/>
  <text x="60" y="345" class="title" fill="#1976D2">VPC (10.0.0.0/16) - us-west-2</text>
  
  <!-- ========== Availability Zone A ========== -->
  <g id="az-a">
    <rect x="60" y="370" width="640" height="560" class="az-box" rx="8"/>
    <text x="380" y="395" text-anchor="middle" class="title" fill="#757575">Availability Zone A (us-west-2a)</text>
    
    <!-- Public Subnet A -->
    <rect x="80" y="410" width="280" height="150" class="public-subnet" rx="5"/>
    <text x="220" y="430" text-anchor="middle" class="subtitle" font-weight="bold" fill="#2E7D32">Public Subnet A</text>
    <text x="220" y="445" text-anchor="middle" class="label">10.0.1.0/24</text>
    
    <!-- NAT Gateway A -->
    <rect x="95" y="460" width="90" height="45" class="component" rx="3"/>
    <text x="140" y="478" text-anchor="middle" class="small-label" font-weight="bold">NAT Gateway</text>
    <text x="140" y="492" text-anchor="middle" class="small-label">EIP-A</text>
    
    <!-- ALB A -->
    <rect x="200" y="460" width="140" height="80" class="component" rx="3"/>
    <text x="270" y="478" text-anchor="middle" class="small-label" font-weight="bold">Application</text>
    <text x="270" y="492" text-anchor="middle" class="small-label" font-weight="bold">Load Balancer</text>
    <text x="270" y="506" text-anchor="middle" class="small-label">Target Groups:</text>
    <text x="270" y="518" text-anchor="middle" class="small-label" font-size="8px">Customers, Vets</text>
    <text x="270" y="530" text-anchor="middle" class="small-label" font-size="8px">Visits, Admin, API-GW</text>
    
    <!-- Private App Subnet A -->
    <rect x="80" y="580" width="280" height="170" class="private-app-subnet" rx="5"/>
    <text x="220" y="600" text-anchor="middle" class="subtitle" font-weight="bold" fill="#E65100">Private App Subnet A</text>
    <text x="220" y="615" text-anchor="middle" class="label">10.0.3.0/24</text>
    
    <!-- ECS Services A -->
    <g>
      <rect x="95" y="630" width="65" height="60" class="component" rx="3"/>
      <text x="127" y="648" text-anchor="middle" class="small-label" font-weight="bold">ECS</text>
      <text x="127" y="660" text-anchor="middle" class="small-label" font-size="8px">Customers</text>
      <text x="127" y="672" text-anchor="middle" class="small-label" font-size="8px">Service</text>
      <text x="127" y="684" text-anchor="middle" class="small-label" font-size="7px">:8080</text>
    </g>
    <g>
      <rect x="170" y="630" width="65" height="60" class="component" rx="3"/>
      <text x="202" y="648" text-anchor="middle" class="small-label" font-weight="bold">ECS</text>
      <text x="202" y="660" text-anchor="middle" class="small-label" font-size="8px">Vets</text>
      <text x="202" y="672" text-anchor="middle" class="small-label" font-size="8px">Service</text>
      <text x="202" y="684" text-anchor="middle" class="small-label" font-size="7px">:8080</text>
    </g>
    <g>
      <rect x="245" y="630" width="65" height="60" class="component" rx="3"/>
      <text x="277" y="648" text-anchor="middle" class="small-label" font-weight="bold">ECS</text>
      <text x="277" y="660" text-anchor="middle" class="small-label" font-size="8px">Visits</text>
      <text x="277" y="672" text-anchor="middle" class="small-label" font-size="8px">Service</text>
      <text x="277" y="684" text-anchor="middle" class="small-label" font-size="7px">:8080</text>
    </g>
    <g>
      <rect x="95" y="700" width="65" height="38" class="component" rx="3"/>
      <text x="127" y="715" text-anchor="middle" class="small-label" font-size="8px">API</text>
      <text x="127" y="726" text-anchor="middle" class="small-label" font-size="8px">Gateway</text>
      <text x="127" y="734" text-anchor="middle" class="small-label" font-size="7px">:8080</text>
    </g>
    <g>
      <rect x="170" y="700" width="65" height="38" class="component" rx="3"/>
      <text x="202" y="715" text-anchor="middle" class="small-label" font-size="8px">Admin</text>
      <text x="202" y="726" text-anchor="middle" class="small-label" font-size="8px">Server</text>
      <text x="202" y="734" text-anchor="middle" class="small-label" font-size="7px">:9090</text>
    </g>
    
    <!-- Private DB Subnet A -->
    <rect x="80" y="770" width="280" height="140" class="private-db-subnet" rx="5"/>
    <text x="220" y="790" text-anchor="middle" class="subtitle" font-weight="bold" fill="#C2185B">Private DB Subnet A</text>
    <text x="220" y="805" text-anchor="middle" class="label">10.0.5.0/24</text>
    
    <!-- Aurora Primary -->
    <rect x="110" y="820" width="220" height="70" class="component" rx="3"/>
    <text x="220" y="838" text-anchor="middle" class="small-label" font-weight="bold">Aurora MySQL Cluster</text>
    <text x="220" y="853" text-anchor="middle" class="small-label">Primary Writer Instance</text>
    <text x="220" y="868" text-anchor="middle" class="small-label" font-size="8px">Multi-AZ, Auto-failover</text>
    <text x="220" y="882" text-anchor="middle" class="small-label" font-size="8px" fill="#2E7D32">✓ Read/Write</text>
    
    <!-- Lambda in Private App Subnet -->
    <rect x="245" y="700" width="65" height="38" class="component" rx="3" fill="#FFE0B2" stroke="#F57C00"/>
    <text x="277" y="715" text-anchor="middle" class="small-label" font-size="8px" fill="#E65100">Lambda</text>
    <text x="277" y="726" text-anchor="middle" class="small-label" font-size="8px" fill="#E65100">GenAI</text>
  </g>
  
  <!-- ========== Availability Zone B ========== -->
  <g id="az-b">
    <rect x="720" y="370" width="620" height="560" class="az-box" rx="8"/>
    <text x="1030" y="395" text-anchor="middle" class="title" fill="#757575">Availability Zone B (us-west-2b)</text>
    
    <!-- Public Subnet B -->
    <rect x="1060" y="410" width="260" height="150" class="public-subnet" rx="5"/>
    <text x="1190" y="430" text-anchor="middle" class="subtitle" font-weight="bold" fill="#2E7D32">Public Subnet B</text>
    <text x="1190" y="445" text-anchor="middle" class="label">10.0.2.0/24</text>
    
    <!-- NAT Gateway B -->
    <rect x="1075" y="460" width="90" height="45" class="component" rx="3"/>
    <text x="1120" y="478" text-anchor="middle" class="small-label" font-weight="bold">NAT Gateway</text>
    <text x="1120" y="492" text-anchor="middle" class="small-label">EIP-B</text>
    
    <!-- ALB B -->
    <rect x="1180" y="460" width="120" height="80" class="component" rx="3"/>
    <text x="1240" y="478" text-anchor="middle" class="small-label" font-weight="bold">ALB</text>
    <text x="1240" y="492" text-anchor="middle" class="small-label" font-weight="bold">Node B</text>
    <text x="1240" y="506" text-anchor="middle" class="small-label">Same</text>
    <text x="1240" y="518" text-anchor="middle" class="small-label">Target</text>
    <text x="1240" y="530" text-anchor="middle" class="small-label">Groups</text>
    
    <!-- Private App Subnet B -->
    <rect x="1060" y="580" width="260" height="170" class="private-app-subnet" rx="5"/>
    <text x="1190" y="600" text-anchor="middle" class="subtitle" font-weight="bold" fill="#E65100">Private App Subnet B</text>
    <text x="1190" y="615" text-anchor="middle" class="label">10.0.4.0/24</text>
    
    <!-- ECS Services B (mirror) -->
    <g>
      <rect x="1075" y="630" width="65" height="60" class="component" rx="3"/>
      <text x="1107" y="648" text-anchor="middle" class="small-label" font-weight="bold">ECS</text>
      <text x="1107" y="660" text-anchor="middle" class="small-label" font-size="8px">Customers</text>
      <text x="1107" y="672" text-anchor="middle" class="small-label" font-size="8px">Service</text>
    </g>
    <g>
      <rect x="1150" y="630" width="65" height="60" class="component" rx="3"/>
      <text x="1182" y="648" text-anchor="middle" class="small-label" font-weight="bold">ECS</text>
      <text x="1182" y="660" text-anchor="middle" class="small-label" font-size="8px">Vets</text>
      <text x="1182" y="672" text-anchor="middle" class="small-label" font-size="8px">Service</text>
    </g>
    <g>
      <rect x="1225" y="630" width="65" height="60" class="component" rx="3"/>
      <text x="1257" y="648" text-anchor="middle" class="small-label" font-weight="bold">ECS</text>
      <text x="1257" y="660" text-anchor="middle" class="small-label" font-size="8px">Visits</text>
      <text x="1257" y="672" text-anchor="middle" class="small-label" font-size="8px">Service</text>
    </g>
    <g>
      <rect x="1075" y="700" width="65" height="38" class="component" rx="3"/>
      <text x="1107" y="718" text-anchor="middle" class="small-label" font-size="8px">API-GW</text>
    </g>
    <g>
      <rect x="1150" y="700" width="65" height="38" class="component" rx="3"/>
      <text x="1182" y="718" text-anchor="middle" class="small-label" font-size="8px">Admin</text>
    </g>
    
    <!-- Private DB Subnet B -->
    <rect x="1060" y="770" width="260" height="140" class="private-db-subnet" rx="5"/>
    <text x="1190" y="790" text-anchor="middle" class="subtitle" font-weight="bold" fill="#C2185B">Private DB Subnet B</text>
    <text x="1190" y="805" text-anchor="middle" class="label">10.0.6.0/24</text>
    
    <!-- Aurora Replica -->
    <rect x="1090" y="820" width="200" height="70" class="component" rx="3"/>
    <text x="1190" y="838" text-anchor="middle" class="small-label" font-weight="bold">Aurora MySQL</text>
    <text x="1190" y="853" text-anchor="middle" class="small-label">Read Replica Instance</text>
    <text x="1190" y="868" text-anchor="middle" class="small-label" font-size="8px">Automatic Promotion</text>
    <text x="1190" y="882" text-anchor="middle" class="small-label" font-size="8px" fill="#1976D2">✓ Read Only</text>
  </g>
  
  <!-- VPC Endpoints (center) -->
  <g>
    <rect x="740" y="580" width="300" height="160" fill="#E1F5FE" stroke="#0277BD" stroke-width="2" rx="5"/>
    <text x="890" y="605" text-anchor="middle" class="subtitle" font-weight="bold" fill="#0277BD">VPC Endpoints (PrivateLink)</text>
    <text x="890" y="622" text-anchor="middle" class="small-label">Interface Endpoints:</text>
    <text x="890" y="638" text-anchor="middle" class="small-label" font-size="9px">• ECR (API, DKR) - Docker Image Pull</text>
    <text x="890" y="652" text-anchor="middle" class="small-label" font-size="9px">• CloudWatch Logs, Metrics, X-Ray</text>
    <text x="890" y="666" text-anchor="middle" class="small-label" font-size="9px">• Secrets Manager, KMS, SSM</text>
    <text x="890" y="680" text-anchor="middle" class="small-label" font-size="9px">• EC2 Messages (Session Manager)</text>
    <text x="890" y="700" text-anchor="middle" class="small-label">Gateway Endpoint:</text>
    <text x="890" y="714" text-anchor="middle" class="small-label" font-size="9px">• S3 - Backup, Logs Storage</text>
    <text x="890" y="728" text-anchor="middle" class="small-label" font-size="8px" fill="#2E7D32">✓ Private AWS Service Access</text>
  </g>
  
  <!-- Cloud Map Service Discovery -->
  <g>
    <rect x="380" y="420" width="140" height="60" class="aws-service" rx="5"/>
    <text x="450" y="442" text-anchor="middle" class="small-label" font-weight="bold" fill="#FFA000">AWS Cloud Map</text>
    <text x="450" y="457" text-anchor="middle" class="small-label" font-size="8px">Service Discovery</text>
    <text x="450" y="470" text-anchor="middle" class="small-label" font-size="8px">DNS Namespace</text>
  </g>
  
  <!-- External AWS Services (Right Side) -->
  <g id="external-services">
    <!-- ECR -->
    <rect x="1200" y="150" width="150" height="55" class="aws-service" rx="5"/>
    <text x="1275" y="172" text-anchor="middle" class="small-label" font-weight="bold" fill="#FFA000">Amazon ECR</text>
    <text x="1275" y="187" text-anchor="middle" class="small-label" font-size="8px">Docker Registry</text>
    <text x="1275" y="198" text-anchor="middle" class="small-label" font-size="8px">Private Images</text>
    
    <!-- Bedrock -->
    <rect x="1200" y="220" width="150" height="55" class="aws-service" rx="5"/>
    <text x="1275" y="242" text-anchor="middle" class="small-label" font-weight="bold" fill="#FFA000">Amazon Bedrock</text>
    <text x="1275" y="257" text-anchor="middle" class="small-label" font-size="8px">GenAI Models</text>
    <text x="1275" y="268" text-anchor="middle" class="small-label" font-size="8px">Claude, Titan</text>
    
    <!-- CloudWatch -->
    <rect x="740" y="770" width="140" height="60" class="aws-service" rx="5"/>
    <text x="810" y="792" text-anchor="middle" class="small-label" font-weight="bold" fill="#FFA000">CloudWatch</text>
    <text x="810" y="807" text-anchor="middle" class="small-label" font-size="8px">Logs, Metrics</text>
    <text x="810" y="820" text-anchor="middle" class="small-label" font-size="8px">Alarms, Dashboard</text>
    
    <!-- CloudTrail -->
    <rect x="900" y="770" width="140" height="60" class="aws-service" rx="5"/>
    <text x="970" y="792" text-anchor="middle" class="small-label" font-weight="bold" fill="#FFA000">CloudTrail</text>
    <text x="970" y="807" text-anchor="middle" class="small-label" font-size="8px">Audit Logs</text>
    <text x="970" y="820" text-anchor="middle" class="small-label" font-size="8px">Compliance</text>
    
    <!-- Secrets Manager -->
    <rect x="740" y="845" width="140" height="50" class="aws-service" rx="5"/>
    <text x="810" y="867" text-anchor="middle" class="small-label" font-weight="bold" fill="#FFA000">Secrets Manager</text>
    <text x="810" y="882" text-anchor="middle" class="small-label" font-size="8px">DB Credentials</text>
    
    <!-- Systems Manager -->
    <rect x="900" y="845" width="140" height="50" class="aws-service" rx="5"/>
    <text x="970" y="867" text-anchor="middle" class="small-label" font-weight="bold" fill="#FFA000">Systems Manager</text>
    <text x="970" y="882" text-anchor="middle" class="small-label" font-size="8px">Parameter Store</text>
  </g>
  
  <!-- Key Arrows -->
  <!-- Users to CloudFront -->
  <path d="M 650 120 L 200 150" stroke="#8E24AA" stroke-width="2" marker-end="url(#arrowhead-purple)"/>
  
  <!-- Users to Route 53 -->
  <path d="M 680 130 L 350 150" class="arrow"/>
  
  <!-- CloudFront to S3 -->
  <path d="M 140 220 L 140 250" stroke="#8E24AA" stroke-width="2" marker-end="url(#arrowhead-purple)"/>
  
  <!-- Route 53 to ALB via IGW -->
  <path d="M 420 220 L 620 240" stroke="#4CAF50" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <path d="M 700 290 L 270 410" stroke="#4CAF50" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <path d="M 700 290 L 1240 410" stroke="#4CAF50" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  
  <!-- ALB to ECS -->
  <path d="M 270 540 L 180 630" stroke="#4CAF50" stroke-width="1.5" marker-end="url(#arrowhead-green)"/>
  <path d="M 270 540 L 250 630" stroke="#4CAF50" stroke-width="1.5" marker-end="url(#arrowhead-green)"/>
  <path d="M 1240 540 L 1150 630" stroke="#4CAF50" stroke-width="1.5" marker-end="url(#arrowhead-green)"/>
  
  <!-- ECS to VPC Endpoints -->
  <path d="M 310 660 L 740 660" stroke="#0277BD" stroke-width="1.5" stroke-dasharray="3,3" marker-end="url(#arrowhead)"/>
  <path x="1060 660 L 1040 660" stroke="#0277BD" stroke-width="1.5" stroke-dasharray="3,3" marker-end="url(#arrowhead)"/>
  
  <!-- ECS to Aurora -->
  <path d="M 180 690 L 220 820" stroke="#E91E63" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M 1150 690 L 1190 820" stroke="#E91E63" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Aurora Replication -->
  <path d="M 330 855 L 1090 855" stroke="#9C27B0" stroke-width="3" stroke-dasharray="6,6" marker-end="url(#arrowhead)"/>
  <text x="710" y="845" text-anchor="middle" class="small-label" fill="#9C27B0" font-weight="bold">Async Replication</text>
  
  <!-- Lambda to Bedrock -->
  <path d="M 310 719 L 1200 247" stroke="#FF6F00" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrowhead-orange)"/>
  <text x="750" y="480" text-anchor="middle" class="small-label" fill="#FF6F00" font-size="8px">GenAI API Call</text>
  
  <!-- NAT to Internet -->
  <path d="M 140 460 L 620 290" stroke="#FF6F00" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrowhead-orange)"/>
  <path d="M 1120 460 L 780 290" stroke="#FF6F00" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrowhead-orange)"/>
  
  <!-- Legend -->
  <g transform="translate(40, 960)">
    <text x="0" y="0" class="subtitle" font-weight="bold">Architecture Components:</text>
    <text x="0" y="20" class="small-label">• Frontend: CloudFront + S3 Static Website</text>
    <text x="0" y="35" class="small-label">• Backend: ECS Fargate Microservices (5 services)</text>
    <text x="350" y="20" class="small-label">• Database: Aurora MySQL Multi-AZ</text>
    <text x="350" y="35" class="small-label">• AI: Lambda + Bedrock (Claude/Titan)</text>
    <text x="700" y="20" class="small-label">• Security: WAF, Private Subnets, VPC Endpoints</text>
    <text x="700" y="35" class="small-label">• Monitoring: CloudWatch, CloudTrail, X-Ray</text>
    <text x="1050" y="20" class="small-label">• HA: Multi-AZ, ALB, Auto-Scaling</text>
    <text x="1050" y="35" class="small-label">• IaC: Terraform (11 Layers)</text>
  </g>
</svg>
