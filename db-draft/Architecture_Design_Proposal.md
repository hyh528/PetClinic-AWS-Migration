### **아키텍처 설계 제안서 (데이터 및 설정)**

**작성자:** (본인 성함)
**역할:** Data & Migration Lead
**작성일:** 2025년 9월 23일
**목표:** 현재 데이터 아키텍처를 분석하고, AWS 환경에 최적화된 데이터베이스 및 설정 관리 방안을 설계하여 제안한다.

---

### **1. 현재(As-Is) 데이터 아키텍처 분석**

(내용 동일)

---

### **2. 목표(To-Be) RDS 구성 방안 (보강)**

(내용 동일)

---

### **3. AWS Parameter Store Key 구조 설계 (상세 설명)**

#### **산출물: Parameter Store Key 구조 설계 문서**

#### **Part 1. 이게 대체 무엇이고, 왜 필요한가요? (What & Why?)**

-   **현재 방식(Config Server):** 지금 우리는 `Config Server`라는 '설정 관리자' 서버를 사용합니다. 각 서비스는 시작할 때마다 이 '설정 관리자'에게 "내 설정 파일 좀 줘!"라고 요청합니다. 그러면 '설정 관리자'는 공개된 인터넷 공간인 **GitHub**에 가서 설정 파일을 가져와 서비스에게 전달합니다.
    -   **문제점:** 이 방식은 마치 **도서관 공개 서가에 DB 비밀번호 같은 중요한 정보를 적어두는 것**과 같습니다. 누구나 볼 수 있어 보안에 매우 취약하며, '설정 관리자' 서버가 다운되면 모든 서비스가 설정을 읽어오지 못해 시작조차 할 수 없는 문제가 있습니다.

-   **새로운 방식(AWS Parameter Store):** `AWS Parameter Store`는 AWS가 직접 관리해주는 **'중앙 보안 금고'** 서비스입니다. 우리는 더 이상 공개된 도서관을 사용하지 않고, DB 비밀번호 같은 모든 중요 설정 정보를 이 '보안 금고' 안에 안전하게 보관할 것입니다.
    -   **핵심 장점 (보안):** 금고의 가장 큰 장점은 각 서비스에게 **자신만의 '개인 금고'만 열 수 있는 전용 열쇠(IAM Role)를 줄 수 있다는 것**입니다. 즉, `customers-service`의 열쇠가 유출되어도, 해커는 `vets-service`의 개인 금고는 절대 열 수 없습니다. 보안 사고의 피해가 격리되고 최소화됩니다.

#### **Part 2. 그래서 왜 이런 Key 구조를 설계했나요? (How?)**

-   **설계 목표:** 수많은 설정 정보를 '중앙 보안 금고'에 체계적으로 보관하려면, 각 정보(Parameter)를 쉽게 찾을 수 있는 **'주소 체계'** 가 반드시 필요합니다. 아래 Key 구조는 바로 그 주소 체계를 설계한 것입니다.

-   **Key 구조 설계:**
    ```
    /{프로젝트명}/{환경명}/{서비스명}/{설정키}
    ```
    -   이 구조는 마치 컴퓨터의 폴더 경로처럼 생겨서, 누가 보더라도 그 의미를 쉽게 파악할 수 있습니다.

-   **주소 체계 설명:**
    -   `/{프로젝트명}` (예: `/petclinic`) : 'PetClinic 프로젝트'라는 가장 큰 최상위 금고실을 의미합니다.
    -   `/{환경명}` (예: `/docker`) : 금고실 안의 '개발 환경' 구역을 의미합니다. 나중에 실제 운영 서버를 위한 'prod' 구역도 만들 것입니다.
    -   `/{서비스명}` (예: `/customers-service`) : '개발 환경' 구역 안의 '고객 서비스팀' 전용 선반을 의미합니다. 모든 서비스에 공통으로 적용될 설정은 `application`이라는 공용 선반을 사용합니다.
    -   `/{설정키}` (예: `/spring/datasource/password`) : 선반 위에 놓인 실제 '개인 금고'의 이름입니다. 기존 설정 파일의 `spring.datasource.password`를 폴더 경로처럼 바꾼 것입니다.

#### **Part 3. 그래서 우리가 얻는 산출물은 무엇인가요? (So What?)**

-   **산출물 설명:** 위와 같은 설계 원칙에 따라, 우리는 기존 설정 파일의 모든 항목을 '중앙 보안 금고'로 이전하기 위한 **'상세 주소 목록'** 을 만들었습니다. 아래 '적용 예시'가 바로 그 결과물(산출물)입니다. 이 목록은 앞으로 우리가 AWS 환경에서 설정을 저장하고 관리하는 기준이 될 것입니다.

-   **적용 예시 (설계도의 최종 결과물):**

    -   **공통 설정 (기존 `application.yml`의 내용):**
        ```
        /petclinic/docker/application/eureka/client/serviceUrl/defaultZone
        ```

    -   **`customers-service`의 개별 설정:**
        ```
        /petclinic/docker/customers-service/server/port
        /petclinic/docker/customers-service/spring/datasource/url
        /petclinic/docker/customers-service/spring/datasource/username
        /petclinic/docker/customers-service/spring/datasource/password
        ```

-   **기대 효과:**
    -   **보안 강화:** IAM 역할을 통해 각 서비스가 자신의 설정값에만 접근하도록 세밀한 권한 제어가 가능합니다.
    -   **감사 및 추적:** 모든 설정 변경 이력이 CloudTrail에 기록되어 추적이 용이합니다.
    -   **관리 용이성:** AWS 콘솔 및 CLI를 통해 설정을 중앙에서 편리하게 관리할 수 있습니다.
